<h1>Banquidle</h1>

<%= render "layouts/flash" %>

<%= form_with url: submit_guess_game_index_path, data: { turbo_stream: true }, method: :post, id: "guess-form" do |f| %>
  <%= f.text_field :quickname, placeholder: "Quickname d'une personne" %>
  <%= f.submit "Envoyer" %>
<% end %>

<table>
  <thead>
  <tr>
    <th>Pr√©nom</th>
    <th>Nom</th>
    <th>Sexe</th>
    <th>Statut Pro</th>
  </tr>
  </thead>
  <tbody id="guesses">
  <%= render partial: "people/person",
             collection: @prev_people,
             locals: { todays: @todays_person } if defined?(@prev_people) %>
  </tbody>
</table>

<div id="congrats-div">
  <% if @prev_people.include?(@todays_person) %>
    <%= render partial: "game/congratulations" %>
  <% end %>
</div>

<p>Person to guess : <%= @todays_person.quickname %></p>

<script>
    document.addEventListener("turbo:submit-end", function (event) {
        if (event.target.id === "guess-form") event.target.reset()
    })
</script>